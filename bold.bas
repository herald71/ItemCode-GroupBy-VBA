'==============================================================================
' 프로시저명: 볼드체처리하기
' 설명: Excel 셀 내의 HTML 볼드 태그(<b>텍스트</b>)를 찾아서
'       태그는 제거하고 해당 텍스트에 실제 볼드 서식을 적용합니다.
' 작성일: 
' 수정이력:
'==============================================================================
Sub 볼드체처리하기()
    '--------------------------------------------------------------------------
    ' 변수 선언부
    '--------------------------------------------------------------------------
    Dim ws As Worksheet          ' 작업할 워크시트 객체
    Dim cell As Range            ' 현재 처리 중인 셀 객체
    Dim startPos As Integer      ' <b> 태그 다음 텍스트의 시작 위치
    Dim textLength As Integer    ' 볼드 처리할 텍스트의 길이
    Dim searchText As String     ' 시작 태그 "<b>"
    Dim boldText As String       ' 종료 태그 "</b>"

    '--------------------------------------------------------------------------
    ' 초기화 및 설정
    '--------------------------------------------------------------------------
    ' 현재 활성화된 시트를 작업 대상으로 설정
    Set ws = ActiveSheet

    ' HTML 볼드 태그 설정
    searchText = "<b>"           ' 볼드 시작 태그
    boldText = "</b>"            ' 볼드 종료 태그

    '--------------------------------------------------------------------------
    ' 메인 처리 로직
    '--------------------------------------------------------------------------
    ' 시트의 사용된 범위(UsedRange)의 모든 셀을 순회하며 검색
    ' UsedRange: 데이터가 있는 셀들의 범위만 처리하여 성능 최적화
    For Each cell In ws.UsedRange
        ' 현재 셀에 <b> 태그와 </b> 태그가 모두 존재하는지 확인
        ' InStr 함수: 문자열 내에서 특정 텍스트의 위치를 반환 (0이면 없음)
        If InStr(cell.Value, searchText) > 0 And InStr(cell.Value, boldText) > 0 Then
            '----------------------------------------------------------------------
            ' 1단계: 볼드 처리할 텍스트의 위치와 길이 계산
            '----------------------------------------------------------------------
            ' 시작 위치: <b> 태그 바로 다음 문자의 위치
            ' 예: "안녕<b>하세요</b>" -> startPos = 4 (하세요의 '하' 위치)
            startPos = InStr(cell.Value, searchText) + Len(searchText)
            
            ' 텍스트 길이: </b> 태그 시작 위치에서 시작 위치를 뺀 값
            ' 예: "안녕<b>하세요</b>" -> textLength = 3 (하세요의 길이)
            textLength = InStr(cell.Value, boldText) - startPos
            
            '----------------------------------------------------------------------
            ' 2단계: HTML 태그 제거
            '----------------------------------------------------------------------
            ' Replace 함수를 사용하여 <b> 태그 제거
            ' 예: "안녕<b>하세요</b>" -> "안녕하세요</b>"
            cell.Value = Replace(cell.Value, searchText, "")
            
            ' </b> 태그도 제거
            ' 예: "안녕하세요</b>" -> "안녕하세요"
            cell.Value = Replace(cell.Value, boldText, "")

            '----------------------------------------------------------------------
            ' 3단계: 볼드 서식 적용
            '----------------------------------------------------------------------
            ' cell.Characters: 셀 내 특정 문자 범위에 대한 서식 지정
            ' Start: 볼드 시작 위치 (태그 제거 후 위치이므로 Len(searchText)만큼 빼줌)
            ' Length: 볼드 처리할 문자의 개수
            ' 예: "안녕하세요"에서 위치 3부터 3글자를 볼드 처리 -> "안녕**하세요**"
            With cell.Characters(Start:=startPos - Len(searchText), Length:=textLength)
                .Font.Bold = True    ' 볼드 서식 적용
            End With
        End If
    Next cell
    
    '--------------------------------------------------------------------------
    ' 처리 완료
    '--------------------------------------------------------------------------
    ' 모든 셀의 처리가 완료되면 프로시저 종료
End Sub

